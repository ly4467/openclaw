import{r as l,W as de,x as Ce,l as Te,a as T,j as t,C as yt,m as Nt,c as wt,i as Je,u as oe,b as ue,y as St,k as kt,L as It,z as Ot}from"./main-BPgb0gzG.js";import{M as Mt,r as Et}from"./index-Dg9IGsTH.js";function Qe(e,n){(n==null||n>e.length)&&(n=e.length);for(var r=0,s=Array(n);r<n;r++)s[r]=e[r];return s}function $t(e){if(Array.isArray(e))return e}function Ct(e,n,r){return(n=At(n))in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function Rt(e,n){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var s,i,a,o,m=[],f=!0,g=!1;try{if(a=(r=r.call(e)).next,n!==0)for(;!(f=(s=a.call(r)).done)&&(m.push(s.value),m.length!==n);f=!0);}catch(M){g=!0,i=M}finally{try{if(!f&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(g)throw i}}return m}}function Pt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ze(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);n&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,s)}return r}function et(e){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?Ze(Object(r),!0).forEach(function(s){Ct(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ze(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function Lt(e,n){if(e==null)return{};var r,s,i=Tt(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(s=0;s<a.length;s++)r=a[s],n.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function Tt(e,n){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(n.indexOf(s)!==-1)continue;r[s]=e[s]}return r}function Vt(e,n){return $t(e)||Rt(e,n)||Dt(e,n)||Pt()}function Bt(e,n){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,n);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function At(e){var n=Bt(e,"string");return typeof n=="symbol"?n:n+""}function Dt(e,n){if(e){if(typeof e=="string")return Qe(e,n);var r={}.toString.call(e).slice(8,-1);return r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set"?Array.from(e):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Qe(e,n):void 0}}function _t(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function tt(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);n&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,s)}return r}function nt(e){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?tt(Object(r),!0).forEach(function(s){_t(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):tt(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function Ft(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return function(s){return n.reduceRight(function(i,a){return a(i)},s)}}function fe(e){return function n(){for(var r=this,s=arguments.length,i=new Array(s),a=0;a<s;a++)i[a]=arguments[a];return i.length>=e.length?e.apply(this,i):function(){for(var o=arguments.length,m=new Array(o),f=0;f<o;f++)m[f]=arguments[f];return n.apply(r,[].concat(i,m))}}}function xe(e){return{}.toString.call(e).includes("Object")}function zt(e){return!Object.keys(e).length}function he(e){return typeof e=="function"}function Ht(e,n){return Object.prototype.hasOwnProperty.call(e,n)}function qt(e,n){return xe(n)||te("changeType"),Object.keys(n).some(function(r){return!Ht(e,r)})&&te("changeField"),n}function Wt(e){he(e)||te("selectorType")}function Ut(e){he(e)||xe(e)||te("handlerType"),xe(e)&&Object.values(e).some(function(n){return!he(n)})&&te("handlersType")}function Kt(e){e||te("initialIsRequired"),xe(e)||te("initialType"),zt(e)&&te("initialContent")}function Gt(e,n){throw new Error(e[n]||e.default)}var Yt={initialIsRequired:"initial state is required",initialType:"initial state should be an object",initialContent:"initial state shouldn't be an empty object",handlerType:"handler should be an object or a function",handlersType:"all handlers should be a functions",selectorType:"selector should be a function",changeType:"provided value of changes should be an object",changeField:'it seams you want to change a field in the state which is not specified in the "initial" state',default:"an unknown error accured in `state-local` package"},te=fe(Gt)(Yt),ve={changes:qt,selector:Wt,handler:Ut,initial:Kt};function Xt(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};ve.initial(e),ve.handler(n);var r={current:e},s=fe(Zt)(r,n),i=fe(Qt)(r),a=fe(ve.changes)(e),o=fe(Jt)(r);function m(){var g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(M){return M};return ve.selector(g),g(r.current)}function f(g){Ft(s,i,a,o)(g)}return[m,f]}function Jt(e,n){return he(n)?n(e.current):n}function Qt(e,n){return e.current=nt(nt({},e.current),n),n}function Zt(e,n,r){return he(n)?n(e.current):Object.keys(r).forEach(function(s){var i;return(i=n[s])===null||i===void 0?void 0:i.call(n,e.current[s])}),r}var en={create:Xt},tn={paths:{vs:"https://cdn.jsdelivr.net/npm/monaco-editor@0.55.1/min/vs"}};function nn(e){return function n(){for(var r=this,s=arguments.length,i=new Array(s),a=0;a<s;a++)i[a]=arguments[a];return i.length>=e.length?e.apply(this,i):function(){for(var o=arguments.length,m=new Array(o),f=0;f<o;f++)m[f]=arguments[f];return n.apply(r,[].concat(i,m))}}}function rn(e){return{}.toString.call(e).includes("Object")}function sn(e){return e||rt("configIsRequired"),rn(e)||rt("configType"),e.urls?(an(),{paths:{vs:e.urls.monacoBase}}):e}function an(){console.warn(dt.deprecation)}function ln(e,n){throw new Error(e[n]||e.default)}var dt={configIsRequired:"the configuration object is required",configType:"the configuration object should be an object",default:"an unknown error accured in `@monaco-editor/loader` package",deprecation:`Deprecation warning!
    You are using deprecated way of configuration.

    Instead of using
      monaco.config({ urls: { monacoBase: '...' } })
    use
      monaco.config({ paths: { vs: '...' } })

    For more please check the link https://github.com/suren-atoyan/monaco-loader#config
  `},rt=nn(ln)(dt),on={config:sn},cn=function(){for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return function(i){return r.reduceRight(function(a,o){return o(a)},i)}};function ut(e,n){return Object.keys(n).forEach(function(r){n[r]instanceof Object&&e[r]&&Object.assign(n[r],ut(e[r],n[r]))}),et(et({},e),n)}var dn={type:"cancelation",msg:"operation is manually canceled"};function Re(e){var n=!1,r=new Promise(function(s,i){e.then(function(a){return n?i(dn):s(a)}),e.catch(i)});return r.cancel=function(){return n=!0},r}var un=["monaco"],fn=en.create({config:tn,isInitialized:!1,resolve:null,reject:null,monaco:null}),ft=Vt(fn,2),ge=ft[0],Ne=ft[1];function mn(e){var n=on.config(e),r=n.monaco,s=Lt(n,un);Ne(function(i){return{config:ut(i.config,s),monaco:r}})}function hn(){var e=ge(function(n){var r=n.monaco,s=n.isInitialized,i=n.resolve;return{monaco:r,isInitialized:s,resolve:i}});if(!e.isInitialized){if(Ne({isInitialized:!0}),e.monaco)return e.resolve(e.monaco),Re(Pe);if(window.monaco&&window.monaco.editor)return mt(window.monaco),e.resolve(window.monaco),Re(Pe);cn(gn,vn)(bn)}return Re(Pe)}function gn(e){return document.body.appendChild(e)}function pn(e){var n=document.createElement("script");return e&&(n.src=e),n}function vn(e){var n=ge(function(s){var i=s.config,a=s.reject;return{config:i,reject:a}}),r=pn("".concat(n.config.paths.vs,"/loader.js"));return r.onload=function(){return e()},r.onerror=n.reject,r}function bn(){var e=ge(function(r){var s=r.config,i=r.resolve,a=r.reject;return{config:s,resolve:i,reject:a}}),n=window.require;n.config(e.config),n(["vs/editor/editor.main"],function(r){var s=r.m||r;mt(s),e.resolve(s)},function(r){e.reject(r)})}function mt(e){ge().monaco||Ne({monaco:e})}function jn(){return ge(function(e){var n=e.monaco;return n})}var Pe=new Promise(function(e,n){return Ne({resolve:e,reject:n})}),ye={config:mn,init:hn,__getMonacoInstance:jn},xn={wrapper:{display:"flex",position:"relative",textAlign:"initial"},fullWidth:{width:"100%"},hide:{display:"none"}},Le=xn,yn={container:{display:"flex",height:"100%",width:"100%",justifyContent:"center",alignItems:"center"}},Nn=yn;function wn({children:e}){return de.createElement("div",{style:Nn.container},e)}var Sn=wn,kn=Sn;function In({width:e,height:n,isEditorReady:r,loading:s,_ref:i,className:a,wrapperProps:o}){return de.createElement("section",{style:{...Le.wrapper,width:e,height:n},...o},!r&&de.createElement(kn,null,s),de.createElement("div",{ref:i,style:{...Le.fullWidth,...!r&&Le.hide},className:a}))}var On=In,ht=l.memo(On);function Mn(e){l.useEffect(e,[])}var Ve=Mn;function En(e,n,r=!0){let s=l.useRef(!0);l.useEffect(s.current||!r?()=>{s.current=!1}:e,n)}var A=En;function me(){}function ce(e,n,r,s){return $n(e,s)||Cn(e,n,r,s)}function $n(e,n){return e.editor.getModel(gt(e,n))}function Cn(e,n,r,s){return e.editor.createModel(n,r,s?gt(e,s):void 0)}function gt(e,n){return e.Uri.parse(n)}function Rn({original:e,modified:n,language:r,originalLanguage:s,modifiedLanguage:i,originalModelPath:a,modifiedModelPath:o,keepCurrentOriginalModel:m=!1,keepCurrentModifiedModel:f=!1,theme:g="light",loading:M="Loading...",options:y={},height:V="100%",width:B="100%",className:H,wrapperProps:q={},beforeMount:R=me,onMount:G=me}){let[N,W]=l.useState(!1),[D,b]=l.useState(!0),x=l.useRef(null),j=l.useRef(null),k=l.useRef(null),w=l.useRef(G),h=l.useRef(R),C=l.useRef(!1);Ve(()=>{let c=ye.init();return c.then(p=>(j.current=p)&&b(!1)).catch(p=>p?.type!=="cancelation"&&console.error("Monaco initialization: error:",p)),()=>x.current?_():c.cancel()}),A(()=>{if(x.current&&j.current){let c=x.current.getOriginalEditor(),p=ce(j.current,e||"",s||r||"text",a||"");p!==c.getModel()&&c.setModel(p)}},[a],N),A(()=>{if(x.current&&j.current){let c=x.current.getModifiedEditor(),p=ce(j.current,n||"",i||r||"text",o||"");p!==c.getModel()&&c.setModel(p)}},[o],N),A(()=>{let c=x.current.getModifiedEditor();c.getOption(j.current.editor.EditorOption.readOnly)?c.setValue(n||""):n!==c.getValue()&&(c.executeEdits("",[{range:c.getModel().getFullModelRange(),text:n||"",forceMoveMarkers:!0}]),c.pushUndoStop())},[n],N),A(()=>{x.current?.getModel()?.original.setValue(e||"")},[e],N),A(()=>{let{original:c,modified:p}=x.current.getModel();j.current.editor.setModelLanguage(c,s||r||"text"),j.current.editor.setModelLanguage(p,i||r||"text")},[r,s,i],N),A(()=>{j.current?.editor.setTheme(g)},[g],N),A(()=>{x.current?.updateOptions(y)},[y],N);let U=l.useCallback(()=>{if(!j.current)return;h.current(j.current);let c=ce(j.current,e||"",s||r||"text",a||""),p=ce(j.current,n||"",i||r||"text",o||"");x.current?.setModel({original:c,modified:p})},[r,n,i,e,s,a,o]),Y=l.useCallback(()=>{!C.current&&k.current&&(x.current=j.current.editor.createDiffEditor(k.current,{automaticLayout:!0,...y}),U(),j.current?.editor.setTheme(g),W(!0),C.current=!0)},[y,g,U]);l.useEffect(()=>{N&&w.current(x.current,j.current)},[N]),l.useEffect(()=>{!D&&!N&&Y()},[D,N,Y]);function _(){let c=x.current?.getModel();m||c?.original?.dispose(),f||c?.modified?.dispose(),x.current?.dispose()}return de.createElement(ht,{width:B,height:V,isEditorReady:N,loading:M,_ref:k,className:H,wrapperProps:q})}var Pn=Rn,Ln=l.memo(Pn);function Tn(){let[e,n]=l.useState(ye.__getMonacoInstance());return Ve(()=>{let r;return e||(r=ye.init(),r.then(s=>{n(s)})),()=>r?.cancel()}),e}var Vn=Tn;function Bn(e){let n=l.useRef();return l.useEffect(()=>{n.current=e},[e]),n.current}var An=Bn,be=new Map;function Dn({defaultValue:e,defaultLanguage:n,defaultPath:r,value:s,language:i,path:a,theme:o="light",line:m,loading:f="Loading...",options:g={},overrideServices:M={},saveViewState:y=!0,keepCurrentModel:V=!1,width:B="100%",height:H="100%",className:q,wrapperProps:R={},beforeMount:G=me,onMount:N=me,onChange:W,onValidate:D=me}){let[b,x]=l.useState(!1),[j,k]=l.useState(!0),w=l.useRef(null),h=l.useRef(null),C=l.useRef(null),U=l.useRef(N),Y=l.useRef(G),_=l.useRef(),c=l.useRef(s),p=An(a),I=l.useRef(!1),J=l.useRef(!1);Ve(()=>{let O=ye.init();return O.then(F=>(w.current=F)&&k(!1)).catch(F=>F?.type!=="cancelation"&&console.error("Monaco initialization: error:",F)),()=>h.current?ne():O.cancel()}),A(()=>{let O=ce(w.current,e||s||"",n||i||"",a||r||"");O!==h.current?.getModel()&&(y&&be.set(p,h.current?.saveViewState()),h.current?.setModel(O),y&&h.current?.restoreViewState(be.get(a)))},[a],b),A(()=>{h.current?.updateOptions(g)},[g],b),A(()=>{!h.current||s===void 0||(h.current.getOption(w.current.editor.EditorOption.readOnly)?h.current.setValue(s):s!==h.current.getValue()&&(J.current=!0,h.current.executeEdits("",[{range:h.current.getModel().getFullModelRange(),text:s,forceMoveMarkers:!0}]),h.current.pushUndoStop(),J.current=!1))},[s],b),A(()=>{let O=h.current?.getModel();O&&i&&w.current?.editor.setModelLanguage(O,i)},[i],b),A(()=>{m!==void 0&&h.current?.revealLine(m)},[m],b),A(()=>{w.current?.editor.setTheme(o)},[o],b);let Q=l.useCallback(()=>{if(!(!C.current||!w.current)&&!I.current){Y.current(w.current);let O=a||r,F=ce(w.current,s||e||"",n||i||"",O||"");h.current=w.current?.editor.create(C.current,{model:F,automaticLayout:!0,...g},M),y&&h.current.restoreViewState(be.get(O)),w.current.editor.setTheme(o),m!==void 0&&h.current.revealLine(m),x(!0),I.current=!0}},[e,n,r,s,i,a,g,M,y,o,m]);l.useEffect(()=>{b&&U.current(h.current,w.current)},[b]),l.useEffect(()=>{!j&&!b&&Q()},[j,b,Q]),c.current=s,l.useEffect(()=>{b&&W&&(_.current?.dispose(),_.current=h.current?.onDidChangeModelContent(O=>{J.current||W(h.current.getValue(),O)}))},[b,W]),l.useEffect(()=>{if(b){let O=w.current.editor.onDidChangeMarkers(F=>{let ie=h.current.getModel()?.uri;if(ie&&F.find(u=>u.path===ie.path)){let u=w.current.editor.getModelMarkers({resource:ie});D?.(u)}});return()=>{O?.dispose()}}return()=>{}},[b,D]);function ne(){_.current?.dispose(),V?y&&be.set(a,h.current.saveViewState()):h.current.getModel()?.dispose(),h.current.dispose()}return de.createElement(ht,{width:B,height:H,isEditorReady:b,loading:f,_ref:C,className:q,wrapperProps:R})}var _n=Dn;l.memo(_n);const st=200*1024;function Be(e){return[...e].sort((n,r)=>{const s=!!Ce.valid(n.version),i=!!Ce.valid(r.version);return s&&i?Ce.rcompare(n.version,r.version):s?-1:i?1:n.version.localeCompare(r.version)})}function pt(e,n){return n?.latest?n.latest:Be(e)[0]?.id??null}function vt(e,n){const r=Be(e);if(!n)return r[1]?.id??null;const s=r.findIndex(i=>i.id===n);return s===-1?r[1]?.id??null:r[s+1]?.id??null}function Fn(e,n){const r=pt(e,n),s=vt(e,r);return{leftId:s??r??null,rightId:r??s??null}}function zn(e,n){const r=new Map;for(const i of e)r.set(i.path,{left:i});for(const i of n){const a=r.get(i.path)??{};r.set(i.path,{...a,right:i})}const s={changed:0,added:1,removed:2,same:3};return Array.from(r.entries()).map(([i,a])=>{let o="same";return a.left&&!a.right?o="removed":!a.left&&a.right?o="added":a.left?.sha256!==a.right?.sha256&&(o="changed"),{path:i,status:o,left:a.left,right:a.right}}).sort((i,a)=>{const o=s[i.status]-s[a.status];return o!==0?o:i.path.localeCompare(a.path)})}function Hn(e){const n=e.find(s=>s.path.toLowerCase()==="skill.md");return n?n.path:e.find(s=>s.status!=="same")?.path??e[0]?.path??null}const ee="";function qn({skill:e,versions:n,variant:r="card"}){const s=Te(T.skills.getFileText),i=Vn(),[a,o]=l.useState("split"),[m,f]=l.useState(null),[g,M]=l.useState(null),[y,V]=l.useState(null),[B,H]=l.useState(ee),[q,R]=l.useState(ee),[G,N]=l.useState(!1),[W,D]=l.useState(null),[b,x]=l.useState(null),j=l.useRef(new Map),k=l.useMemo(()=>n.map(u=>({id:u._id,version:u.version})),[n]),w=l.useMemo(()=>Be(k),[k]),h=l.useMemo(()=>new Map(n.map(u=>[u._id,u])),[n]),C=l.useMemo(()=>pt(k,e.tags),[k,e.tags]),U=l.useMemo(()=>vt(k,C),[k,C]),Y=l.useMemo(()=>{const u=[];if(C){const v=h.get(C)?.version;u.push({value:C,label:v?`latest (v${v})`:"latest",group:"Special"})}if(U){const v=h.get(U)?.version;u.push({value:U,label:v?`previous (v${v})`:"previous",group:"Special"})}else n.length>0&&u.push({value:n[0]._id,label:"previous (unavailable)",group:"Special",disabled:!0});const E=Object.entries(e.tags??{}).filter(([v])=>v!=="latest").sort(([v],[S])=>v.localeCompare(S));for(const[v,S]of E){const $=h.get(S)?.version;u.push({value:S,label:$?`tag: ${v} (v${$})`:`tag: ${v}`,group:"Tags",disabled:!h.has(S)})}for(const v of w)u.push({value:v.id,label:`v${v.version}`,group:"Versions"});return u},[C,U,w,e.tags,h,n]);l.useEffect(()=>{if(!n.length)return;const u=Fn(k,e.tags);f(E=>E&&h.has(E)?E:u.leftId?u.leftId:null),M(E=>E&&h.has(E)?E:u.rightId?u.rightId:null)},[k,e.tags,h,n.length]);const _=m?h.get(m)??null:null,c=g?h.get(g)??null:null,p=l.useMemo(()=>zn(_?.files??[],c?.files??[]),[_,c]);l.useEffect(()=>{if(!p.length){V(null);return}V(u=>u&&p.some(E=>E.path===u)?u:Hn(p))},[p]);const I=l.useMemo(()=>p.find(u=>u.path===y)??null,[p,y]);l.useEffect(()=>{let u=!1;async function E(S,$){const X=`${S}:${$}`,K=j.current.get(X);if(K!==void 0)return K;const ae=await s({versionId:S,path:$});return j.current.set(X,ae.text),ae.text}async function v(){if(!I||!m||!g){H(ee),R(ee);return}N(!0),D(null),x(null);const S=I.left,$=I.right,X=[];if(S&&S.size>st&&X.push({side:"left",path:S.path}),$&&$.size>st&&X.push({side:"right",path:$.path}),X.length){u||(x(X[0]),H(ee),R(ee),N(!1));return}try{const[K,ae]=await Promise.all([S?E(m,S.path):Promise.resolve(""),$?E(g,$.path):Promise.resolve("")]);if(u)return;H(K??ee),R(ae??ee)}catch(K){if(u)return;D(K instanceof Error?K.message:"Failed to load diff")}finally{u||N(!1)}}return v(),()=>{u=!0}},[s,m,g,I]),l.useEffect(()=>{if(!i||typeof document>"u")return;const u=new MutationObserver(()=>{at(i)});return u.observe(document.documentElement,{attributes:!0,attributeFilter:["data-theme"]}),at(i),()=>u.disconnect()},[i]);const J=_?`v${_.version}`:"—",Q=c?`v${c.version}`:"—",ne=n.length<2,O=!!(m&&g),F=!!I,ie=r==="card"?"card diff-card":"diff-card diff-card-embedded";return t.jsxs("div",{className:ie,children:[t.jsxs("div",{className:"diff-header",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"section-title",style:{fontSize:"1.2rem",margin:0},children:"Compare versions"}),t.jsx("p",{className:"section-subtitle",style:{margin:0},children:"Inline or side-by-side diff for any file."})]}),t.jsxs("fieldset",{className:"diff-toggle-group",children:[t.jsx("legend",{className:"sr-only",children:"Diff layout"}),t.jsx("button",{className:`diff-toggle${a==="split"?" is-active":""}`,type:"button",onClick:()=>o("split"),children:"Side-by-side"}),t.jsx("button",{className:`diff-toggle${a==="inline"?" is-active":""}`,type:"button",onClick:()=>o("inline"),children:"Inline"})]})]}),t.jsxs("div",{className:"diff-controls",children:[t.jsxs("div",{className:"diff-select",children:[t.jsx("label",{htmlFor:"diff-left",children:"Left"}),t.jsxs("select",{id:"diff-left",className:"search-input",value:m??"",onChange:u=>f(u.target.value),children:[t.jsx("option",{value:"",disabled:!0,children:"Select version"}),it(Y)]})]}),t.jsx("button",{className:"btn diff-swap",type:"button",onClick:()=>{f(g),M(m)},disabled:!m||!g,children:"Swap"}),t.jsxs("div",{className:"diff-select",children:[t.jsx("label",{htmlFor:"diff-right",children:"Right"}),t.jsxs("select",{id:"diff-right",className:"search-input",value:g??"",onChange:u=>M(u.target.value),children:[t.jsx("option",{value:"",disabled:!0,children:"Select version"}),it(Y)]})]})]}),t.jsxs("div",{className:"diff-meta",children:[t.jsxs("span",{children:["Left ",J," • Right ",Q]}),ne?t.jsx("span",{children:"Need at least 2 versions."}):null]}),t.jsxs("div",{className:"diff-layout",children:[t.jsx("div",{className:"diff-files",children:p.length===0?t.jsx("div",{className:"diff-empty",children:"No files to compare."}):p.map(u=>t.jsxs("button",{type:"button",className:`diff-file${u.path===y?" is-active":""}`,onClick:()=>V(u.path),children:[t.jsx("span",{className:`diff-pill diff-pill-${u.status}`,children:u.status}),t.jsx("span",{className:"diff-file-name",children:u.path})]},u.path))}),t.jsx("div",{className:"diff-view",children:W?t.jsx("div",{className:"diff-empty",children:W}):b?t.jsxs("div",{className:"diff-empty",children:[b.side==="left"?"Left":"Right"," file exceeds 200KB:"," ",b.path]}):ne?t.jsx("div",{className:"diff-empty",children:"Publish another version to compare."}):O?F?t.jsxs(yt,{fallback:t.jsx("div",{className:"diff-empty",children:"Preparing diff…"}),children:[t.jsx(Ln,{className:"diff-monaco",original:B,modified:q,theme:Wn(),loading:t.jsx("div",{className:"diff-empty",children:"Loading diff…"}),options:Un(a)}),G?t.jsx("div",{className:"diff-loading",children:"Loading…"}):null]}):t.jsx("div",{className:"diff-empty",children:"Select a file to compare."}):t.jsx("div",{className:"diff-empty",children:"Select two versions to compare."})})]})]})}function it(e){const n={Special:[],Tags:[],Versions:[]};for(const r of e)n[r.group].push(r);return["Special","Tags","Versions"].filter(r=>n[r].length>0).map(r=>t.jsx("optgroup",{label:r,children:n[r].map(s=>t.jsx("option",{value:s.value,disabled:s.disabled,children:s.label},`${r}-${s.value}`))},r))}function Wn(){return typeof document>"u"?"clawhub-light":document.documentElement.dataset.theme==="dark"?"clawhub-dark":"clawhub-light"}function Un(e){return{readOnly:!0,renderSideBySide:e==="split",renderSideBySideInlineBreakpoint:860,wordWrap:"on",minimap:{enabled:!1},scrollBeyondLastLine:!1,overviewRulerBorder:!1,renderIndicators:!0,diffAlgorithm:"advanced",fontFamily:"var(--font-mono)",fontSize:13}}function at(e){const n=getComputedStyle(document.documentElement),r=je(n.getPropertyValue("--surface").trim()||"#ffffff"),s=n.getPropertyValue("--surface-muted").trim()||"#f6f1ec",i=n.getPropertyValue("--ink").trim()||"#1d1a17",a=n.getPropertyValue("--ink-soft").trim()||"#4c463f",o=n.getPropertyValue("--line").trim()||"rgba(29, 26, 23, 0.12)",m=n.getPropertyValue("--accent").trim()||"#ff6b4a",f=n.getPropertyValue("--seafoam").trim()||"#2bc6a4",g=n.getPropertyValue("--diff-added").trim()||f,M=n.getPropertyValue("--diff-removed").trim()||m,y=r,V=s,B=document.documentElement.dataset.theme==="dark",H=B?"vs-dark":"vs",q=se(g,B?.12:.16),R=se(M,B?.12:.16);e.editor.defineTheme(`clawhub-${B?"dark":"light"}`,{base:H,inherit:!0,rules:[{token:"",foreground:je(i)},{token:"comment",foreground:je(a)}],colors:{"editor.background":y,"editor.foreground":i,"editorLineNumber.foreground":a,"editorLineNumber.activeForeground":i,"editorGutter.background":V,"editor.selectionBackground":se(m,.18),"editor.inactiveSelectionBackground":se(m,.12),"editorWidget.background":r,"editorWidget.border":o,"editorWidget.foreground":i,"diffEditor.insertedTextBackground":q,"diffEditor.removedTextBackground":R,"diffEditor.insertedLineBackground":q,"diffEditor.removedLineBackground":R,"diffEditor.border":o,"scrollbarSlider.background":se(a,.15),"scrollbarSlider.hoverBackground":se(a,.28),"scrollbarSlider.activeBackground":se(a,.4)}}),e.editor.setTheme(`clawhub-${B?"dark":"light"}`)}function je(e){return e.startsWith("#")&&e.length===4?`#${e[1]}${e[1]}${e[2]}${e[2]}${e[3]}${e[3]}`:e}function se(e,n){const r=je(e).replace("#","");if(r.length!==6)return e;const s=Number.parseInt(r.slice(0,2),16),i=Number.parseInt(r.slice(2,4),16),a=Number.parseInt(r.slice(4,6),16);return`rgba(${s}, ${i}, ${a}, ${n})`}function lt({className:e}){return t.jsxs("svg",{className:e,width:"1em",height:"1em",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 100 89","aria-label":"VirusTotal",children:[t.jsx("title",{children:"VirusTotal"}),t.jsx("path",{fill:"currentColor",fillRule:"evenodd",d:"M45.292 44.5 0 89h100V0H0l45.292 44.5zM90 80H22l35.987-35.2L22 9h68v71z"})]})}function Kn(e){switch(e.toLowerCase()){case"benign":case"clean":return{label:"Benign",className:"scan-status-clean"};case"malicious":return{label:"Malicious",className:"scan-status-malicious"};case"suspicious":return{label:"Suspicious",className:"scan-status-suspicious"};case"loading":return{label:"Loading...",className:"scan-status-pending"};case"pending":case"not_found":return{label:"Pending",className:"scan-status-pending"};case"error":case"failed":return{label:"Error",className:"scan-status-error"};default:return{label:e,className:"scan-status-unknown"}}}function Gn(e,n=!0){const r=Te(T.vt.fetchResults),[s,i]=l.useState(null),[a,o]=l.useState(!1);return l.useEffect(()=>{if(!e||!n){i(null),o(!1);return}let m=!1;return o(!0),r({sha256hash:e}).then(f=>{m||(i(f),o(!1))}).catch(()=>{m||(i({status:"error"}),o(!1))}),()=>{m=!0}},[e,n,r]),{result:s,loading:a}}function ot({sha256hash:e,variant:n="panel",enabled:r=!0}){const{result:s,loading:i}=Gn(e,r);if(!e)return null;const a=i?"loading":s?.status??"pending",o=s?.url,m=Kn(a),f=s?.metadata,g=s?.source==="code_insight",M=f?.aiAnalysis,y=m.label;return n==="badge"?t.jsxs("div",{className:"version-scan-badge",children:[t.jsx(lt,{className:"version-scan-icon version-scan-icon-vt"}),t.jsx("span",{className:m.className,children:y}),o?t.jsx("a",{href:o,target:"_blank",rel:"noopener noreferrer",className:"version-scan-link",onClick:V=>V.stopPropagation(),children:"↗"}):null]}):t.jsxs("div",{className:"scan-results-panel",children:[t.jsx("div",{className:"scan-results-title",children:"Security Scan"}),t.jsxs("div",{className:"scan-results-list",children:[t.jsxs("div",{className:"scan-result-row",children:[t.jsxs("div",{className:"scan-result-scanner",children:[t.jsx(lt,{className:"scan-result-icon scan-result-icon-vt"}),t.jsx("span",{className:"scan-result-scanner-name",children:"VirusTotal"})]}),t.jsx("div",{className:`scan-result-status ${m.className}`,children:y}),o?t.jsx("a",{href:o,target:"_blank",rel:"noopener noreferrer",className:"scan-result-link",children:"View report →"}):null]}),g&&M&&(a==="malicious"||a==="suspicious")?t.jsxs("div",{className:"code-insight-analysis",children:[t.jsx("div",{className:"code-insight-label",children:"Code Insight"}),t.jsx("p",{className:"code-insight-text",children:M})]}):null]})]})}function Yn(e){if(e&&typeof e=="object"&&"data"in e){const n=e.data;if(typeof n=="string"&&n.trim())return n.trim();if(n&&typeof n=="object"&&"message"in n&&typeof n.message=="string"){const r=n.message?.trim();if(r)return r}}if(e instanceof Error){const n=e.message.replace(/\[CONVEX[^\]]*\]\s*/g,"").replace(/\[Request ID:[^\]]*\]\s*/g,"").replace(/^Server Error Called by client\s*/i,"").replace(/^ConvexError:\s*/i,"").trim();if(n&&n!=="Server Error")return n}return"Unable to submit report. Please try again."}function Xn({slug:e,canonicalOwner:n,redirectToCanonical:r}){const s=Nt(),{isAuthenticated:i,me:a}=wt(),o=Je(a),m=oe(T.skills.getBySlugForStaff,o?{slug:e}:"skip"),f=oe(T.skills.getBySlug,o?"skip":{slug:e}),g=o?m:f,M=ue(T.stars.toggle),y=ue(T.skills.report),V=ue(T.comments.add),B=ue(T.comments.remove),H=ue(T.skills.updateTags),q=Te(T.skills.getReadme),[R,G]=l.useState(null),[N,W]=l.useState(null),[D,b]=l.useState(""),[x,j]=l.useState("latest"),[k,w]=l.useState(""),[h,C]=l.useState("files"),[U,Y]=l.useState({}),_=g===void 0,c=g?.skill,p=g?.owner,I=g?.latestVersion,J=oe(T.skills.listVersions,c?{skillId:c._id,limit:50}:"skip"),Q=oe(T.skills.listVersions,c?{skillId:c._id,limit:200}:"skip"),ne=oe(T.stars.isStarred,i&&c?{skillId:c._id}:"skip"),O=oe(T.comments.listBySkill,c?{skillId:c._id,limit:50}:"skip"),F=St(a,c),u=p?.handle??p?.name??null??(p?._id?String(p._id):null),E=!!(u&&(r||typeof n=="string"&&n&&n!==u)),v=g?.forkOf??null,S=g?.canonical??null,$=g?.moderationInfo??null,X=v?.kind==="duplicate"?"duplicate of":"fork of",K=v?.owner?.handle??null,ae=v?.owner?.userId??null,we=S?.owner?.handle??null,jt=S?.owner?.userId??null,Ae=v?.skill?.slug?ct(K,ae,v.skill.slug):null,De=S?.skill?.slug&&S.skill.slug!==v?.skill?.slug?ct(we,jt,S.skill.slug):null,pe=o&&c?c:null,_e=pe?.moderationStatus??(pe?.softDeletedAt?"hidden":void 0),Fe=_e==="hidden"||!!pe?.softDeletedAt,Se=_e==="removed",ke=Fe&&pe?.moderationReason==="auto.reports",Ie=Se?"Removed":ke?"Auto-hidden":Fe?"Hidden":null,ze=Ie?ke?"Auto-hidden after 4+ unique reports.":Se?"Removed from public view.":"Hidden from public view.":null;l.useEffect(()=>{!E||!u||s({to:"/$owner/$slug",params:{owner:u,slug:e},replace:!0})},[s,u,e,E]);const xt=new Map((Q??J??[]).map(d=>[d._id,d])),P=I?.parsed?.clawdis,Oe=l.useMemo(()=>Qn(P?.os),[P?.os]),z=P?.requires,He=P?.install??[],re=P?.nix?.plugin,qe=P?.nix?.systems??[],Me=re?nr(re):null,Z=P?.config,We=Z?.example?bt(Z.example):null,Ee=P?.cliHelp,Ue=!!(P?.emoji||Oe.length||z?.bins?.length||z?.anyBins?.length||z?.env?.length||z?.config?.length||P?.primaryEnv),Ke=He.length>0,Ge=!!(Me||Z||Ee),Ye=l.useMemo(()=>R?Jn(R):null,[R]),$e=I?.files??[];if(l.useEffect(()=>{if(!I)return;G(null),W(null);let d=!1;return q({versionId:I._id}).then(L=>{d||G(L.text)}).catch(L=>{d||(W(L instanceof Error?L.message:"Failed to load README"),G(null))}),()=>{d=!0}},[I,q]),l.useEffect(()=>{!k&&I&&w(I._id)},[I,k]),_||E)return t.jsx("main",{className:"section",children:t.jsx("div",{className:"card",children:t.jsx("div",{className:"loading-indicator",children:"Loading skill…"})})});if(g===null||!c)return t.jsx("main",{className:"section",children:t.jsx("div",{className:"card",children:"Skill not found."})});const Xe=Object.entries(c.tags??{});return t.jsx("main",{className:"section",children:t.jsxs("div",{className:"skill-detail-stack",children:[$?.isPendingScan?t.jsx("div",{className:"pending-banner",children:t.jsxs("div",{className:"pending-banner-content",children:[t.jsx("strong",{children:"Security scan in progress"}),t.jsx("p",{children:"Your skill is being scanned by VirusTotal. It will be visible to others once the scan completes and passes review."})]})}):$?.isMalwareBlocked?t.jsx("div",{className:"pending-banner pending-banner-blocked",children:t.jsxs("div",{className:"pending-banner-content",children:[t.jsx("strong",{children:"Skill blocked — security issue detected"}),t.jsx("p",{children:"VirusTotal flagged this skill as potentially malicious. It is not visible to others and downloads are disabled. Review the scan results below."})]})}):$?.isRemoved?t.jsx("div",{className:"pending-banner pending-banner-blocked",children:t.jsxs("div",{className:"pending-banner-content",children:[t.jsx("strong",{children:"Skill removed by moderator"}),t.jsx("p",{children:"This skill has been removed and is not visible to others."})]})}):$?.isHiddenByMod?t.jsx("div",{className:"pending-banner pending-banner-blocked",children:t.jsxs("div",{className:"pending-banner-content",children:[t.jsx("strong",{children:"Skill hidden"}),t.jsx("p",{children:"This skill is currently hidden and not visible to others."})]})}):null,t.jsxs("div",{className:"card skill-hero",children:[t.jsxs("div",{className:`skill-hero-top${Ge?" has-plugin":""}`,children:[t.jsxs("div",{className:"skill-hero-header",children:[t.jsxs("div",{className:"skill-hero-title",children:[t.jsxs("div",{className:"skill-hero-title-row",children:[t.jsx("h1",{className:"section-title",style:{margin:0},children:c.displayName}),re?t.jsx("span",{className:"tag tag-accent",children:"Plugin bundle (nix)"}):null]}),t.jsx("p",{className:"section-subtitle",children:c.summary??"No summary provided."}),o&&ze?t.jsx("div",{className:"skill-hero-note",children:ze}):null,re?t.jsx("div",{className:"skill-hero-note",children:"Bundles the skill pack, CLI binary, and config requirements in one Nix install."}):null,t.jsxs("div",{className:"stat",children:["⭐ ",c.stats.stars," · ⤓ ",c.stats.downloads," · ⤒"," ",c.stats.installsCurrent??0," current · ",c.stats.installsAllTime??0," ","all-time"]}),p?.handle?t.jsxs("div",{className:"stat",children:["by ",t.jsxs("a",{href:`/u/${p.handle}`,children:["@",p.handle]})]}):null,v&&Ae?t.jsxs("div",{className:"stat",children:[X," ",t.jsxs("a",{href:Ae,children:[K?`@${K}/`:"",v.skill.slug]}),v.version?` (based on ${v.version})`:null]}):null,De?t.jsxs("div",{className:"stat",children:["canonical:"," ",t.jsxs("a",{href:De,children:[we?`@${we}/`:"",S?.skill?.slug]})]}):null,kt(c).map(d=>t.jsx("div",{className:"tag",children:d},d)),o&&Ie?t.jsx("div",{className:`tag${ke||Se?" tag-accent":""}`,children:Ie}):null,t.jsxs("div",{className:"skill-actions",children:[i?t.jsx("button",{className:`star-toggle${ne?" is-active":""}`,type:"button",onClick:()=>{M({skillId:c._id})},"aria-label":ne?"Unstar skill":"Star skill",children:t.jsx("span",{"aria-hidden":"true",children:"★"})}):null,i?t.jsx("button",{className:"btn btn-ghost",type:"button",onClick:async()=>{const d=window.prompt("Report this skill? A reason is required. Abuse may result in a ban.");if(d===null)return;const L=d.trim();if(!L){window.alert("Report reason required.");return}try{(await y({skillId:c._id,reason:L})).reported?window.alert("Thanks — your report has been submitted."):window.alert("You have already reported this skill.")}catch(le){console.error("Failed to report skill",le),window.alert(Yn(le))}},children:"Report"}):null,o?t.jsx(It,{className:"btn",to:"/management",search:{skill:c.slug},children:"Manage"}):null]}),i?t.jsx("div",{className:"section-subtitle",style:{margin:"6px 0 0"},children:"Reports require a reason. Abuse may result in a ban."}):null,t.jsx(ot,{sha256hash:I?.sha256hash}),I?.sha256hash?t.jsx("p",{className:"scan-disclaimer",children:"Like a lobster shell, security has layers — review code before you run it."}):null]}),t.jsxs("div",{className:"skill-hero-cta",children:[t.jsxs("div",{className:"skill-version-pill",children:[t.jsx("span",{className:"skill-version-label",children:"Current version"}),t.jsxs("strong",{children:["v",I?.version??"—"]})]}),!re&&!$?.isMalwareBlocked&&!$?.isRemoved?t.jsx("a",{className:"btn btn-primary",href:`undefined/api/v1/download?slug=${c.slug}`,children:"Download zip"}):null]})]}),Ge?t.jsxs("div",{className:"skill-panel bundle-card",children:[t.jsxs("div",{className:"bundle-header",children:[t.jsx("div",{className:"bundle-title",children:"Plugin bundle (nix)"}),t.jsx("div",{className:"bundle-subtitle",children:"Skill pack · CLI binary · Config"})]}),t.jsxs("div",{className:"bundle-includes",children:[t.jsx("span",{children:"SKILL.md"}),t.jsx("span",{children:"CLI"}),t.jsx("span",{children:"Config"})]}),Z?t.jsxs("div",{className:"bundle-section",children:[t.jsx("div",{className:"bundle-section-title",children:"Config requirements"}),t.jsxs("div",{className:"bundle-meta",children:[Z.requiredEnv?.length?t.jsxs("div",{className:"stat",children:[t.jsx("strong",{children:"Required env"}),t.jsx("span",{children:Z.requiredEnv.join(", ")})]}):null,Z.stateDirs?.length?t.jsxs("div",{className:"stat",children:[t.jsx("strong",{children:"State dirs"}),t.jsx("span",{children:Z.stateDirs.join(", ")})]}):null]})]}):null,Ee?t.jsxs("details",{className:"bundle-section bundle-details",children:[t.jsx("summary",{children:"CLI help (from plugin)"}),t.jsx("pre",{className:"hero-install-code mono",children:Ee})]}):null]}):null]}),t.jsx("div",{className:"skill-tag-row",children:Xe.length===0?t.jsx("span",{className:"section-subtitle",style:{margin:0},children:"No tags yet."}):Xe.map(([d,L])=>t.jsxs("span",{className:"tag",children:[d,t.jsxs("span",{className:"tag-meta",children:["v",xt.get(L)?.version??L]})]},d))}),F?t.jsxs("form",{onSubmit:d=>{d.preventDefault(),!(!x.trim()||!k)&&H({skillId:c._id,tags:[{tag:x.trim(),versionId:k}]})},className:"tag-form",children:[t.jsx("input",{className:"search-input",value:x,onChange:d=>j(d.target.value),placeholder:"latest"}),t.jsx("select",{className:"search-input",value:k??"",onChange:d=>w(d.target.value),children:(Q??[]).map(d=>t.jsxs("option",{value:d._id,children:["v",d.version]},d._id))}),t.jsx("button",{className:"btn",type:"submit",children:"Update tag"})]}):null,Ue||Ke?t.jsx("div",{className:"skill-hero-content",children:t.jsxs("div",{className:"skill-hero-panels",children:[Ue?t.jsxs("div",{className:"skill-panel",children:[t.jsx("h3",{className:"section-title",style:{fontSize:"1rem",margin:0},children:"Runtime requirements"}),t.jsxs("div",{className:"skill-panel-body",children:[P?.emoji?t.jsxs("div",{className:"tag",children:[P.emoji," Clawdis"]}):null,Oe.length?t.jsxs("div",{className:"stat",children:[t.jsx("strong",{children:"OS"}),t.jsx("span",{children:Oe.join(" · ")})]}):null,z?.bins?.length?t.jsxs("div",{className:"stat",children:[t.jsx("strong",{children:"Bins"}),t.jsx("span",{children:z.bins.join(", ")})]}):null,z?.anyBins?.length?t.jsxs("div",{className:"stat",children:[t.jsx("strong",{children:"Any bin"}),t.jsx("span",{children:z.anyBins.join(", ")})]}):null,z?.env?.length?t.jsxs("div",{className:"stat",children:[t.jsx("strong",{children:"Env"}),t.jsx("span",{children:z.env.join(", ")})]}):null,z?.config?.length?t.jsxs("div",{className:"stat",children:[t.jsx("strong",{children:"Config"}),t.jsx("span",{children:z.config.join(", ")})]}):null,P?.primaryEnv?t.jsxs("div",{className:"stat",children:[t.jsx("strong",{children:"Primary env"}),t.jsx("span",{children:P.primaryEnv})]}):null]})]}):null,Ke?t.jsxs("div",{className:"skill-panel",children:[t.jsx("h3",{className:"section-title",style:{fontSize:"1rem",margin:0},children:"Install"}),t.jsx("div",{className:"skill-panel-body",children:He.map((d,L)=>{const le=er(d);return t.jsx("div",{className:"stat",children:t.jsxs("div",{children:[t.jsx("strong",{children:d.label??Zn(d)}),d.bins?.length?t.jsxs("div",{style:{color:"var(--ink-soft)",fontSize:"0.85rem"},children:["Bins: ",d.bins.join(", ")]}):null,le?t.jsx("code",{children:le}):null]})},`${d.id??d.kind}-${L}`)})})]}):null]})}):null]}),Me?t.jsxs("div",{className:"card",children:[t.jsx("h2",{className:"section-title",style:{fontSize:"1.2rem",margin:0},children:"Install via Nix"}),t.jsx("p",{className:"section-subtitle",style:{margin:0},children:qe.length?`Systems: ${qe.join(", ")}`:"nix-clawdbot"}),t.jsx("pre",{className:"hero-install-code",style:{marginTop:12},children:Me})]}):null,We?t.jsxs("div",{className:"card",children:[t.jsx("h2",{className:"section-title",style:{fontSize:"1.2rem",margin:0},children:"Config example"}),t.jsx("p",{className:"section-subtitle",style:{margin:0},children:"Starter config for this plugin bundle."}),t.jsx("pre",{className:"hero-install-code",style:{marginTop:12},children:We})]}):null,t.jsxs("div",{className:"card tab-card",children:[t.jsxs("div",{className:"tab-header",children:[t.jsx("button",{className:`tab-button${h==="files"?" is-active":""}`,type:"button",onClick:()=>C("files"),children:"Files"}),t.jsx("button",{className:`tab-button${h==="compare"?" is-active":""}`,type:"button",onClick:()=>C("compare"),children:"Compare"}),t.jsx("button",{className:`tab-button${h==="versions"?" is-active":""}`,type:"button",onClick:()=>C("versions"),children:"Versions"})]}),h==="files"?t.jsxs("div",{className:"tab-body",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"section-title",style:{fontSize:"1.2rem",margin:0},children:"SKILL.md"}),t.jsx("div",{className:"markdown",children:Ye?t.jsx(Mt,{remarkPlugins:[Et],children:Ye}):N?t.jsxs("div",{className:"stat",children:["Failed to load SKILL.md: ",N]}):t.jsx("div",{children:"Loading…"})})]}),t.jsxs("div",{className:"file-list",children:[t.jsxs("div",{className:"file-list-header",children:[t.jsx("h3",{className:"section-title",style:{fontSize:"1.05rem",margin:0},children:"Files"}),t.jsxs("span",{className:"section-subtitle",style:{margin:0},children:[$e.length," total"]})]}),t.jsx("div",{className:"file-list-body",children:$e.length===0?t.jsx("div",{className:"stat",children:"No files available."}):$e.map(d=>t.jsxs("div",{className:"file-row",children:[t.jsx("span",{className:"file-path",children:d.path}),t.jsx("span",{className:"file-meta",children:tr(d.size)})]},d.path))})]})]}):null,h==="compare"&&c?t.jsx("div",{className:"tab-body",children:t.jsx(qn,{skill:c,versions:Q??[],variant:"embedded"})}):null,h==="versions"?t.jsxs("div",{className:"tab-body",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"section-title",style:{fontSize:"1.2rem",margin:0},children:"Versions"}),t.jsx("p",{className:"section-subtitle",style:{margin:0},children:re?"Review release history and changelog.":"Download older releases or scan the changelog."})]}),t.jsx("div",{className:"version-scroll",children:t.jsx("div",{className:"version-list",children:(J??[]).map(d=>t.jsxs("div",{className:"version-row",children:[t.jsxs("div",{className:"version-info",children:[t.jsxs("div",{children:["v",d.version," · ",new Date(d.createdAt).toLocaleDateString(),d.changelogSource==="auto"?t.jsx("span",{style:{color:"var(--ink-soft)"},children:" · auto"}):null]}),t.jsx("div",{style:{color:"#5c554e",whiteSpace:"pre-wrap"},children:d.changelog}),t.jsx("div",{className:"version-scan-results",children:d.sha256hash?U[d._id]?t.jsx(ot,{sha256hash:d.sha256hash,variant:"badge",enabled:!0}):t.jsx("button",{className:"version-scan-toggle",type:"button",onClick:()=>Y(L=>({...L,[d._id]:!0})),children:"Load scan"}):null})]}),re?null:t.jsx("div",{className:"version-actions",children:t.jsx("a",{className:"btn version-zip",href:`undefined/api/v1/download?slug=${c.slug}&version=${d.version}`,children:"Zip"})})]},d._id))})})]}):null]}),t.jsxs("div",{className:"card",children:[t.jsx("h2",{className:"section-title",style:{fontSize:"1.2rem",margin:0},children:"Comments"}),i?t.jsxs("form",{onSubmit:d=>{d.preventDefault(),D.trim()&&V({skillId:c._id,body:D.trim()}).then(()=>b(""))},className:"comment-form",children:[t.jsx("textarea",{className:"comment-input",rows:4,value:D,onChange:d=>b(d.target.value),placeholder:"Leave a note…"}),t.jsx("button",{className:"btn comment-submit",type:"submit",children:"Post comment"})]}):t.jsx("p",{className:"section-subtitle",children:"Sign in to comment."}),t.jsx("div",{style:{display:"grid",gap:12,marginTop:16},children:(O??[]).length===0?t.jsx("div",{className:"stat",children:"No comments yet."}):(O??[]).map(d=>t.jsxs("div",{className:"stat",style:{alignItems:"flex-start"},children:[t.jsxs("div",{children:[t.jsxs("strong",{children:["@",d.user?.handle??d.user?.name??"user"]}),t.jsx("div",{style:{color:"#5c554e"},children:d.comment.body})]}),i&&a&&(a._id===d.comment.userId||Je(a))?t.jsx("button",{className:"btn",type:"button",onClick:()=>{B({commentId:d.comment._id})},children:"Delete"}):null]},d.comment._id))})]})]})})}function ct(e,n,r){return`/${e?.trim()||(n?String(n):"unknown")}/${r}`}function bt(e){if(!e.trim()||e.includes(`
`))return e;try{const m=JSON.parse(e);return JSON.stringify(m,null,2)}catch{}let r="",s=0,i=!1,a=!1;const o=()=>{r=r.replace(/[ \t]+$/u,""),r+=`
${" ".repeat(s*2)}`};for(let m=0;m<e.length;m+=1){const f=e[m];if(i){r+=f,a?a=!1:f==="\\"?a=!0:f==='"'&&(i=!1);continue}if(f==='"'){i=!0,r+=f;continue}if(f==="{"||f==="["){r+=f,s+=1,o();continue}if(f==="}"||f==="]"){s=Math.max(0,s-1),o(),r+=f;continue}if(f===";"||f===","){r+=f,o();continue}if(!(f===`
`||f==="\r"||f==="	")){if(f===" "){if(r.endsWith(" ")||r.endsWith(`
`))continue;r+=" ";continue}r+=f}}return r.trim()}function Jn(e){const n=e.replace(/\r\n/g,`
`).replace(/\r/g,`
`);if(!n.startsWith("---"))return e;const r=n.indexOf(`
---`,3);return r===-1?e:n.slice(r+4).replace(/^\n+/,"")}function Qn(e){return e?.length?e.map(n=>{const r=n.trim().toLowerCase();return r==="darwin"||r==="macos"||r==="mac"?"macOS":r==="linux"?"Linux":r==="windows"||r==="win32"?"Windows":n}):[]}function Zn(e){return e.kind==="brew"?"Homebrew":e.kind==="node"?"Node":e.kind==="go"?"Go":e.kind==="uv"?"uv":"Install"}function er(e){return e.kind==="brew"&&e.formula?e.tap&&!e.formula.includes("/")?`brew install ${e.tap}/${e.formula}`:`brew install ${e.formula}`:e.kind==="node"&&e.package?`npm i -g ${e.package}`:e.kind==="go"&&e.module?`go install ${e.module}`:e.kind==="uv"&&e.package?`uv tool install ${e.package}`:null}function tr(e){if(!Number.isFinite(e))return"—";if(e<1024)return`${e} B`;const n=["KB","MB","GB"];let r=e/1024,s=0;for(;r>=1024&&s<n.length-1;)r/=1024,s+=1;return`${r.toFixed(r>=10?0:1)} ${n[s]}`}function nr(e){const n=`programs.clawdbot.plugins = [ { source = "${e}"; } ];`;return bt(n)}function ir(){const{owner:e,slug:n}=Ot.useParams();return t.jsx(Xn,{slug:n,canonicalOwner:e})}export{ir as component};
