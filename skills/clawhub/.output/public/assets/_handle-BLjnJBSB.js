import{s as I,u as r,a as d,r as m,j as s,S as g,k as y,b as R}from"./main-BPgb0gzG.js";function A(){const{handle:n}=I.useParams(),c=r(d.users.me),e=r(d.users.getByHandle,{handle:n}),o=r(d.skills.list,e?{ownerUserId:e._id,limit:50}:"skip"),i=r(d.stars.listByUser,e?{userId:e._id,limit:50}:"skip"),a=!!(c&&e&&c._id===e._id),[l,h]=m.useState("stars"),[u,p]=m.useState(!1),b=r(d.telemetry.getMyInstalled,a&&l==="installed"?{includeRemoved:u}:"skip");if(m.useEffect(()=>{!a&&l==="installed"&&h("stars")},[a,l]),e===void 0)return s.jsx("main",{className:"section",children:s.jsx("div",{className:"card",children:s.jsx("div",{className:"loading-indicator",children:"Loading user…"})})});if(e===null)return s.jsx("main",{className:"section",children:s.jsx("div",{className:"card",children:"User not found."})});const x=e.image,j=e.displayName??e.name??e.handle??"User",f=e.handle??e.name??n,k=j.charAt(0).toUpperCase(),S=i===void 0,N=i??[],w=o===void 0,v=o??[];return s.jsxs("main",{className:"section",children:[s.jsxs("div",{className:"card settings-profile",style:{marginBottom:22},children:[s.jsx("div",{className:"settings-avatar","aria-hidden":"true",children:x?s.jsx("img",{src:x,alt:""}):s.jsx("span",{children:k})}),s.jsxs("div",{className:"settings-profile-body",children:[s.jsx("div",{className:"settings-name",children:j}),s.jsxs("div",{className:"settings-handle",children:["@",f]})]})]}),a?s.jsxs("div",{className:"profile-tabs",role:"tablist","aria-label":"Profile tabs",children:[s.jsx("button",{className:l==="stars"?"profile-tab is-active":"profile-tab",type:"button",role:"tab","aria-selected":l==="stars",onClick:()=>h("stars"),children:"Stars"}),s.jsx("button",{className:l==="installed"?"profile-tab is-active":"profile-tab",type:"button",role:"tab","aria-selected":l==="installed",onClick:()=>h("installed"),children:"Installed"})]}):null,l==="installed"&&a?s.jsx(C,{includeRemoved:u,onToggleRemoved:()=>p(t=>!t),data:b}):s.jsxs(s.Fragment,{children:[s.jsx("h2",{className:"section-title",style:{fontSize:"1.3rem"},children:"Published"}),s.jsx("p",{className:"section-subtitle",children:"Skills published by this user."}),w?s.jsx("div",{className:"card",children:s.jsx("div",{className:"loading-indicator",children:"Loading published skills…"})}):v.length>0?s.jsx("div",{className:"grid",style:{marginBottom:18},children:v.map(t=>s.jsx(g,{skill:t,badge:y(t),summaryFallback:"Agent-ready skill pack.",meta:s.jsxs("div",{className:"stat",children:["⭐ ",t.stats.stars," · ⤓ ",t.stats.downloads," · ⤒"," ",t.stats.installsAllTime??0]})},t._id))}):null,s.jsx("h2",{className:"section-title",style:{fontSize:"1.3rem"},children:"Stars"}),s.jsx("p",{className:"section-subtitle",children:"Skills this user has starred."}),S?s.jsx("div",{className:"card",children:s.jsx("div",{className:"loading-indicator",children:"Loading stars…"})}):N.length===0?s.jsx("div",{className:"card",children:"No stars yet."}):s.jsx("div",{className:"grid",children:N.map(t=>s.jsx(g,{skill:t,badge:y(t),summaryFallback:"Agent-ready skill pack.",meta:s.jsxs("div",{className:"stat",children:["⭐ ",t.stats.stars," · ⤓ ",t.stats.downloads," · ⤒"," ",t.stats.installsAllTime??0]})},t._id))})]})]})}function C(n){const c=R(d.telemetry.clearMyTelemetry),[e,o]=m.useState(!1),i=n.data;return i===void 0?s.jsxs(s.Fragment,{children:[s.jsx("h2",{className:"section-title",style:{fontSize:"1.3rem"},children:"Installed"}),s.jsx("div",{className:"card",children:s.jsx("div",{className:"loading-indicator",children:"Loading telemetry…"})})]}):i===null?s.jsxs(s.Fragment,{children:[s.jsx("h2",{className:"section-title",style:{fontSize:"1.3rem"},children:"Installed"}),s.jsx("div",{className:"card",children:"Sign in to view your installed skills."})]}):s.jsxs(s.Fragment,{children:[s.jsx("h2",{className:"section-title",style:{fontSize:"1.3rem"},children:"Installed"}),s.jsx("p",{className:"section-subtitle",style:{maxWidth:760},children:"Private view. Only you can see your folders/roots. Everyone else only sees aggregated install counts per skill."}),s.jsxs("div",{className:"profile-actions",children:[s.jsx("button",{className:"btn",type:"button",onClick:n.onToggleRemoved,children:n.includeRemoved?"Hide removed":"Show removed"}),s.jsx("button",{className:"btn",type:"button",onClick:()=>o(a=>!a),children:e?"Hide JSON":"Show JSON"}),s.jsx("button",{className:"btn",type:"button",onClick:()=>{window.confirm("Delete all telemetry data?")&&c()},children:"Delete telemetry"})]}),e?s.jsx("div",{className:"card telemetry-json",style:{marginBottom:18},children:s.jsx("pre",{className:"mono",style:{margin:0,whiteSpace:"pre-wrap"},children:JSON.stringify(i,null,2)})}):null,i.roots.length===0?s.jsx("div",{className:"card",children:"No telemetry yet. Run `clawhub sync` from the CLI."}):s.jsx("div",{style:{display:"grid",gap:16},children:i.roots.map(a=>s.jsxs("div",{className:"card telemetry-root",children:[s.jsxs("div",{className:"telemetry-root-header",children:[s.jsxs("div",{children:[s.jsx("div",{className:"telemetry-root-title",children:a.label}),s.jsxs("div",{className:"telemetry-root-meta",children:["Last sync ",new Date(a.lastSeenAt).toLocaleString(),a.expiredAt?" · stale":""]})]}),s.jsxs("div",{className:"tag",children:[a.skills.length," skills"]})]}),a.skills.length===0?s.jsx("div",{className:"stat",children:"No skills found in this root."}):s.jsx("div",{className:"telemetry-skill-list",children:a.skills.map(l=>s.jsxs("div",{className:"telemetry-skill-row",children:[s.jsxs("a",{className:"telemetry-skill-link",href:`/${encodeURIComponent(String(l.skill.ownerUserId))}/${l.skill.slug}`,children:[s.jsx("span",{children:l.skill.displayName}),s.jsxs("span",{className:"telemetry-skill-slug",children:["/",l.skill.slug]})]}),s.jsxs("div",{className:"telemetry-skill-meta mono",children:[l.lastVersion?`v${l.lastVersion}`:"v?"," ",l.removedAt?"· removed":""]})]},`${a.rootId}:${l.skill.slug}`))})]},a.rootId))})]})}export{A as component};
