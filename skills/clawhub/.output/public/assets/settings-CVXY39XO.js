import{u as v,a,b as i,r as n,j as e,g as L}from"./main-BPgb0gzG.js";function I(){const t=v(a.users.me),N=i(a.users.updateProfile),b=i(a.users.deleteAccount),o=v(a.tokens.listMine),y=i(a.tokens.create),f=i(a.tokens.revoke),[r,d]=n.useState(""),[u,m]=n.useState(""),[h,k]=n.useState(null),[p,S]=n.useState("CLI token"),[x,C]=n.useState(null);if(n.useEffect(()=>{t&&(d(t.displayName??""),m(t.bio??""))},[t]),!t)return e.jsx("main",{className:"section",children:e.jsx("div",{className:"card",children:"Sign in to access settings."})});const g=t.image??(t.email?L(t.email,160):void 0),l=t.displayName??t.name??t.handle??"Profile",j=t.handle??(t.email?t.email.split("@")[0]:void 0);async function w(s){s.preventDefault(),await N({displayName:r,bio:u}),k("Saved.")}async function T(){window.confirm("Soft delete your account? This cannot be undone.")&&await b()}async function A(){const s=p.trim()||"CLI token",D=await y({label:s});C(D.token)}return e.jsxs("main",{className:"section settings-shell",children:[e.jsx("h1",{className:"section-title",children:"Settings"}),e.jsxs("div",{className:"card settings-profile",children:[e.jsx("div",{className:"settings-avatar",children:g?e.jsx("img",{src:g,alt:l}):e.jsx("span",{children:l[0]?.toUpperCase()??"U"})}),e.jsxs("div",{className:"settings-profile-body",children:[e.jsx("div",{className:"settings-name",children:l}),j?e.jsxs("div",{className:"settings-handle",children:["@",j]}):null,t.email?e.jsx("div",{className:"settings-email",children:t.email}):null]})]}),e.jsxs("form",{className:"card settings-card",onSubmit:w,children:[e.jsxs("label",{className:"settings-field",children:[e.jsx("span",{children:"Display name"}),e.jsx("input",{className:"settings-input",value:r,onChange:s=>d(s.target.value)})]}),e.jsxs("label",{className:"settings-field",children:[e.jsx("span",{children:"Bio"}),e.jsx("textarea",{className:"settings-input",rows:5,value:u,onChange:s=>m(s.target.value),placeholder:"Tell people what you're building."})]}),e.jsxs("div",{className:"settings-actions",children:[e.jsx("button",{className:"btn btn-primary settings-save",type:"submit",children:"Save"}),h?e.jsx("div",{className:"stat",children:h}):null]})]}),e.jsxs("div",{className:"card settings-card",children:[e.jsx("h2",{className:"section-title danger-title",style:{marginTop:0},children:"API tokens"}),e.jsx("p",{className:"section-subtitle",children:"Use these tokens for the `clawhub` CLI. Tokens are shown once on creation."}),e.jsxs("div",{className:"settings-field",children:[e.jsx("span",{children:"Label"}),e.jsx("input",{className:"settings-input",value:p,onChange:s=>S(s.target.value),placeholder:"CLI token"})]}),e.jsxs("div",{className:"settings-actions",children:[e.jsx("button",{className:"btn btn-primary settings-save",type:"button",onClick:()=>{A()},children:"Create token"}),x?e.jsxs("div",{className:"stat",style:{overflowX:"auto"},children:[e.jsx("div",{style:{marginBottom:8},children:"Copy this token now:"}),e.jsx("code",{children:x})]}):null]}),(o??[]).length?e.jsx("div",{style:{display:"grid",gap:10,marginTop:16},children:(o??[]).map(s=>e.jsxs("div",{className:"stat",style:{display:"flex",justifyContent:"space-between",gap:12},children:[e.jsxs("div",{children:[e.jsxs("div",{children:[e.jsx("strong",{children:s.label})," ",e.jsxs("span",{style:{opacity:.7},children:["(",s.prefix,"…)"]})]}),e.jsxs("div",{style:{opacity:.7},children:["Created ",c(s.createdAt),s.lastUsedAt?` · Used ${c(s.lastUsedAt)}`:"",s.revokedAt?` · Revoked ${c(s.revokedAt)}`:""]})]}),e.jsx("div",{children:e.jsx("button",{className:"btn",type:"button",disabled:!!s.revokedAt,onClick:()=>{f({tokenId:s._id})},children:s.revokedAt?"Revoked":"Revoke"})})]},s._id))}):e.jsx("p",{className:"section-subtitle",style:{marginTop:16},children:"No tokens yet."})]}),e.jsxs("div",{className:"card danger-card",children:[e.jsx("h2",{className:"section-title danger-title",children:"Danger zone"}),e.jsx("p",{className:"section-subtitle",children:"Soft delete your account. Skills remain public."}),e.jsx("button",{className:"btn btn-danger",type:"button",onClick:()=>{T()},children:"Delete account"})]})]})}function c(t){try{return new Date(t).toLocaleString()}catch{return String(t)}}export{I as component};
